const a43_0x84b61b=a43_0x457e;function a43_0x3c4f(){const _0x3b87fd=['getNext','base64','hasSenderMessageKey','serialize','6HTtMAD','2747160ZVDxCr','47192urMWVm','239TcHQAQ','decrypt','exports','setSenderChainKey','25ECZkGv','3642NQnffj','2559195LTGydz','getSenderKeyState','Over\x202000\x20messages\x20into\x20the\x20future!','5949310tUXcYF','No\x20sender\x20key\x20for:\x20','getSigningKeyPrivate','getSenderChainKey','senderKeyStore','getIteration','from','getKeyId','getPlainText','Received\x20message\x20with\x20old\x20counter:\x20','removeSenderMessageKey','string','encrypt','loadSenderKey','InvalidMessageException','4449347IouTvk','getSenderKey','NoSessionException','getCipherText','storeSenderKey','senderKeyName','4737888MLVSeS','getSenderMessageKey'];a43_0x3c4f=function(){return _0x3b87fd;};return a43_0x3c4f();}function a43_0x457e(_0x4f70cb,_0x2b0d87){const _0x3c4fde=a43_0x3c4f();return a43_0x457e=function(_0x457e83,_0x502a9f){_0x457e83=_0x457e83-0x147;let _0x376425=_0x3c4fde[_0x457e83];return _0x376425;},a43_0x457e(_0x4f70cb,_0x2b0d87);}(function(_0x41450e,_0x167678){const _0x2895ce=a43_0x457e,_0x374d3c=_0x41450e();while(!![]){try{const _0x415892=parseInt(_0x2895ce(0x16c))/0x1*(parseInt(_0x2895ce(0x14a))/0x2)+-parseInt(_0x2895ce(0x14b))/0x3+parseInt(_0x2895ce(0x16b))/0x4*(parseInt(_0x2895ce(0x149))/0x5)+parseInt(_0x2895ce(0x169))/0x6*(parseInt(_0x2895ce(0x15d))/0x7)+parseInt(_0x2895ce(0x16a))/0x8+-parseInt(_0x2895ce(0x163))/0x9+parseInt(_0x2895ce(0x14e))/0xa;if(_0x415892===_0x167678)break;else _0x374d3c['push'](_0x374d3c['shift']());}catch(_0x14ec4e){_0x374d3c['push'](_0x374d3c['shift']());}}}(a43_0x3c4f,0xa8213));const SenderKeyMessage=require('./sender_key_message'),crypto=require('libsignal/src/crypto');class GroupCipher{constructor(_0x39be40,_0x1c760a){const _0x5d7da2=a43_0x457e;this[_0x5d7da2(0x152)]=_0x39be40,this[_0x5d7da2(0x162)]=_0x1c760a;}async[a43_0x84b61b(0x15a)](_0x376a84){const _0x3bfa8c=a43_0x84b61b;try{const _0x343db9=await this[_0x3bfa8c(0x152)]['loadSenderKey'](this[_0x3bfa8c(0x162)]),_0x4e0de9=_0x343db9['getSenderKeyState'](),_0xf83172=_0x4e0de9[_0x3bfa8c(0x151)]()['getSenderMessageKey'](),_0x9e2bea=await this['getCipherText'](_0xf83172['getIv'](),_0xf83172['getCipherKey'](),_0x376a84),_0x3f08d2=new SenderKeyMessage(_0x4e0de9[_0x3bfa8c(0x155)](),_0xf83172[_0x3bfa8c(0x153)](),_0x9e2bea,_0x4e0de9[_0x3bfa8c(0x150)]());return _0x4e0de9['setSenderChainKey'](_0x4e0de9[_0x3bfa8c(0x151)]()['getNext']()),await this[_0x3bfa8c(0x152)][_0x3bfa8c(0x161)](this['senderKeyName'],_0x343db9),_0x3f08d2[_0x3bfa8c(0x168)]();}catch(_0x48198a){throw new Error(_0x3bfa8c(0x15f));}}async[a43_0x84b61b(0x16d)](_0x4f9d03){const _0x3c3a2d=a43_0x84b61b,_0x4ad5d1=await this[_0x3c3a2d(0x152)][_0x3c3a2d(0x15b)](this[_0x3c3a2d(0x162)]);if(!_0x4ad5d1)throw new Error(_0x3c3a2d(0x14f)+this[_0x3c3a2d(0x162)]);const _0x26aa71=new SenderKeyMessage(null,null,null,null,_0x4f9d03),_0x3aeb5c=_0x4ad5d1[_0x3c3a2d(0x14c)](_0x26aa71['getKeyId']()),_0x5d0a00=this[_0x3c3a2d(0x15e)](_0x3aeb5c,_0x26aa71[_0x3c3a2d(0x153)]()),_0x544cab=await this['getPlainText'](_0x5d0a00['getIv'](),_0x5d0a00['getCipherKey'](),_0x26aa71[_0x3c3a2d(0x160)]());return await this[_0x3c3a2d(0x152)][_0x3c3a2d(0x161)](this[_0x3c3a2d(0x162)],_0x4ad5d1),_0x544cab;}['getSenderKey'](_0xb93d57,_0x83e5dd){const _0x399dc5=a43_0x84b61b;let _0x3b20a4=_0xb93d57[_0x399dc5(0x151)]();if(_0x3b20a4[_0x399dc5(0x153)]()>_0x83e5dd){if(_0xb93d57[_0x399dc5(0x167)](_0x83e5dd))return _0xb93d57[_0x399dc5(0x158)](_0x83e5dd);throw new Error(_0x399dc5(0x157)+_0x3b20a4[_0x399dc5(0x153)]()+',\x20'+_0x83e5dd);}if(_0x3b20a4['getIteration']()-_0x83e5dd>0x7d0)throw new Error(_0x399dc5(0x14d));while(_0x3b20a4[_0x399dc5(0x153)]()<_0x83e5dd){_0xb93d57['addSenderMessageKey'](_0x3b20a4[_0x399dc5(0x164)]()),_0x3b20a4=_0x3b20a4[_0x399dc5(0x165)]();}return _0xb93d57[_0x399dc5(0x148)](_0x3b20a4[_0x399dc5(0x165)]()),_0x3b20a4[_0x399dc5(0x164)]();}[a43_0x84b61b(0x156)](_0x102940,_0x1505ae,_0x2167a8){const _0x256a31=a43_0x84b61b;try{const _0x1ae175=crypto[_0x256a31(0x16d)](_0x1505ae,_0x2167a8,_0x102940);return _0x1ae175;}catch(_0x4262a6){throw new Error(_0x256a31(0x15c));}}[a43_0x84b61b(0x160)](_0x44adf0,_0x2aab2b,_0x5381ba){const _0x5d6da8=a43_0x84b61b;try{_0x44adf0=typeof _0x44adf0===_0x5d6da8(0x159)?Buffer['from'](_0x44adf0,'base64'):_0x44adf0,_0x2aab2b=typeof _0x2aab2b===_0x5d6da8(0x159)?Buffer[_0x5d6da8(0x154)](_0x2aab2b,_0x5d6da8(0x166)):_0x2aab2b;const _0x5f2178=crypto[_0x5d6da8(0x15a)](_0x2aab2b,Buffer[_0x5d6da8(0x154)](_0x5381ba),_0x44adf0);return _0x5f2178;}catch(_0x1ea62d){throw new Error(_0x5d6da8(0x15c));}}}module[a43_0x84b61b(0x147)]=GroupCipher;