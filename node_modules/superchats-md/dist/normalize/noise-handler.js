'use strict';const a38_0x13880c=a38_0x320d;(function(_0x3e3ad6,_0x283886){const _0xe7df2d=a38_0x320d,_0x3b9792=_0x3e3ad6();while(!![]){try{const _0x2c1bab=-parseInt(_0xe7df2d(0x218))/0x1*(parseInt(_0xe7df2d(0x216))/0x2)+-parseInt(_0xe7df2d(0x1ff))/0x3+parseInt(_0xe7df2d(0x229))/0x4*(-parseInt(_0xe7df2d(0x21a))/0x5)+parseInt(_0xe7df2d(0x204))/0x6+parseInt(_0xe7df2d(0x213))/0x7+parseInt(_0xe7df2d(0x21f))/0x8*(-parseInt(_0xe7df2d(0x20f))/0x9)+-parseInt(_0xe7df2d(0x208))/0xa*(-parseInt(_0xe7df2d(0x203))/0xb);if(_0x2c1bab===_0x283886)break;else _0x3b9792['push'](_0x3b9792['shift']());}catch(_0x329e30){_0x3b9792['push'](_0x3b9792['shift']());}}}(a38_0x3c7b,0x97fb7));Object[a38_0x13880c(0x219)](exports,a38_0x13880c(0x206),{'value':!![]}),exports[a38_0x13880c(0x22a)]=void 0x0;function a38_0x320d(_0x2a05f0,_0x136403){const _0x3c7b68=a38_0x3c7b();return a38_0x320d=function(_0x320ded,_0xc640ab){_0x320ded=_0x320ded-0x1f3;let _0x1a313a=_0x3c7b68[_0x320ded];return _0x1a313a;},a38_0x320d(_0x2a05f0,_0x136403);}const crypto_1=require(a38_0x13880c(0x202)),bin_1=require('../bin'),crypto_2=require(a38_0x13880c(0x20c)),mode_1=require('../mode'),bin_2=require(a38_0x13880c(0x212)),boom_1=require(a38_0x13880c(0x214)),binary_1=require(a38_0x13880c(0x20d)),generateIV=_0x497088=>{const _0x991f96=new ArrayBuffer(0xc);return new DataView(_0x991f96)['setUint32'](0x8,_0x497088),new Uint8Array(_0x991f96);},makeNoiseHandler=({public:_0x159ee8,private:_0x423262})=>{const _0x2aeaaa=a38_0x13880c,_0x55ee79=_0x126f48=>{const _0x232e54=a38_0x320d;!_0x3df28e&&(_0x4ad40a=(0x0,crypto_1[_0x232e54(0x222)])(Buffer[_0x232e54(0x21d)](bin_1[_0x232e54(0x21e)]['build'](_0x4ad40a,_0x126f48)[_0x232e54(0x210)]())));},_0x2fd739=_0x3fa59b=>{const _0x206521=a38_0x320d,_0x5d2f2d=0x80>>0x3,_0x375408=(0x0,crypto_2[_0x206521(0x1fb)])(_0x206521(0x207),_0x4d75e5,generateIV(_0x42d13f),{'authTagLength':_0x5d2f2d});_0x375408[_0x206521(0x220)](_0x4ad40a);const _0x4dfb8e=Buffer[_0x206521(0x1fa)]([_0x375408[_0x206521(0x200)](_0x3fa59b),_0x375408['final'](),_0x375408[_0x206521(0x20b)]()]);return _0x42d13f+=0x1,_0x55ee79(_0x4dfb8e),_0x4dfb8e;},_0x352f1e=_0x2bca7c=>{const _0x5ad172=a38_0x320d,_0x3da959=generateIV(_0x3df28e?_0x5082e9:_0x42d13f),_0x24702b=(0x0,crypto_2[_0x5ad172(0x224)])(_0x5ad172(0x207),_0x328c1a,_0x3da959),_0x56a77e=0x80>>0x3,_0x360018=_0x2bca7c[_0x5ad172(0x205)](0x0,_0x2bca7c[_0x5ad172(0x201)]-_0x56a77e),_0x144598=_0x2bca7c['slice'](_0x2bca7c[_0x5ad172(0x201)]-_0x56a77e);_0x24702b['setAAD'](_0x4ad40a),_0x24702b['setAuthTag'](_0x144598);const _0x2a1822=Buffer[_0x5ad172(0x1fa)]([_0x24702b['update'](_0x360018),_0x24702b[_0x5ad172(0x1fc)]()]);if(_0x3df28e)_0x5082e9+=0x1;else _0x42d13f+=0x1;return _0x55ee79(_0x2bca7c),_0x2a1822;},_0x51d427=_0x3d66a2=>{const _0x1fb724=a38_0x320d,_0x3c6822=(0x0,crypto_1['hkdf'])(Buffer['from'](_0x3d66a2),0x40,{'salt':_0x1e237d,'info':''});return[_0x3c6822[_0x1fb724(0x205)](0x0,0x20),_0x3c6822['slice'](0x20)];},_0x44d70a=_0x5a2870=>{const [_0x2e7f84,_0x30ae7a]=_0x51d427(_0x5a2870);_0x1e237d=_0x2e7f84,_0x4d75e5=_0x30ae7a,_0x328c1a=_0x30ae7a,_0x5082e9=0x0,_0x42d13f=0x0;},_0x301127=()=>{const _0x41b9db=a38_0x320d,[_0x2c46a5,_0x22bc14]=_0x51d427(new Uint8Array(0x0));_0x4d75e5=_0x2c46a5,_0x328c1a=_0x22bc14,_0x4ad40a=Buffer[_0x41b9db(0x21d)]([]),_0x5082e9=0x0,_0x42d13f=0x0,_0x3df28e=!![];},_0x598bcd=bin_1['Binary'][_0x2aeaaa(0x226)](mode_1[_0x2aeaaa(0x1f9)])['readBuffer']();let _0x4ad40a=Buffer[_0x2aeaaa(0x21d)](_0x598bcd[_0x2aeaaa(0x223)]===0x20?_0x598bcd:(0x0,crypto_1[_0x2aeaaa(0x222)])(Buffer['from'](_0x598bcd))),_0x1e237d=_0x4ad40a,_0x4d75e5=_0x4ad40a,_0x328c1a=_0x4ad40a,_0x5082e9=0x0,_0x42d13f=0x0,_0x3df28e=![],_0x5dfc3e=![];const _0xf1e8be=new bin_1['Binary'](),_0x52386d=new bin_1[(_0x2aeaaa(0x21e))]();return _0x55ee79(mode_1['NOISE_WA_HEADER']),_0x55ee79(_0x159ee8),{'encrypt':_0x2fd739,'decrypt':_0x352f1e,'authenticate':_0x55ee79,'mixIntoKey':_0x44d70a,'finishInit':_0x301127,'processHandshake':({serverHello:_0x370db1},_0x1c615d)=>{const _0x7ec35a=_0x2aeaaa;_0x55ee79(_0x370db1[_0x7ec35a(0x1f8)]),_0x44d70a(crypto_1[_0x7ec35a(0x225)][_0x7ec35a(0x1f4)](_0x423262,_0x370db1[_0x7ec35a(0x1f8)]));const _0x7f997c=_0x352f1e(_0x370db1['static']);_0x44d70a(crypto_1[_0x7ec35a(0x225)]['sharedKey'](_0x423262,_0x7f997c));const _0x5e5c32=_0x352f1e(_0x370db1[_0x7ec35a(0x21c)]),{details:_0x29588d,signature:_0x3e913b}=binary_1[_0x7ec35a(0x1fe)][_0x7ec35a(0x20a)][_0x7ec35a(0x215)](_0x5e5c32),{issuer:_0x3cb718,key:_0x322f7c}=binary_1[_0x7ec35a(0x1fe)]['Details'][_0x7ec35a(0x215)](_0x29588d);if(Buffer[_0x7ec35a(0x1f6)](_0x7f997c,_0x322f7c)!==0x0)throw new boom_1['Boom'](_0x7ec35a(0x1f5),{'statusCode':0x190});const _0x4b5fc2=_0x2fd739(_0x1c615d[_0x7ec35a(0x20e)]);return _0x44d70a(crypto_1[_0x7ec35a(0x225)]['sharedKey'](_0x1c615d[_0x7ec35a(0x227)],_0x370db1[_0x7ec35a(0x1f8)])),_0x4b5fc2;},'encodeFrame':_0x5111b0=>{const _0x3669b9=_0x2aeaaa;_0x3df28e&&(_0x5111b0=_0x2fd739(_0x5111b0));const _0x4e4d88=_0x5dfc3e?0x0:mode_1[_0x3669b9(0x1f3)][_0x3669b9(0x201)];_0xf1e8be['ensureAdditionalCapacity'](_0x4e4d88+0x3+_0x5111b0[_0x3669b9(0x223)]);!_0x5dfc3e&&(_0xf1e8be[_0x3669b9(0x217)](mode_1[_0x3669b9(0x1f3)]),_0x5dfc3e=!![]);_0xf1e8be[_0x3669b9(0x1f7)](_0x5111b0[_0x3669b9(0x223)]>>0x10),_0xf1e8be['writeUint16'](0xffff&_0x5111b0['byteLength']),_0xf1e8be[_0x3669b9(0x221)](_0x5111b0);const _0x3b911f=_0xf1e8be['readByteArray']();return _0x3b911f;},'decodeFrame':(_0x29ea27,_0x5c526a)=>{const _0x3a055c=_0x2aeaaa,_0x4b739a=()=>{const _0x2f09ff=a38_0x320d;return _0x52386d[_0x2f09ff(0x209)]()<<0x10|_0x52386d[_0x2f09ff(0x228)]();},_0x4cdd4a=()=>{const _0x3fc89b=a38_0x320d;return!(_0x52386d[_0x3fc89b(0x21b)]()<0x3)&&_0x4b739a()<=_0x52386d['size']();};_0x52386d[_0x3a055c(0x217)](_0x29ea27);while(_0x52386d['peek'](_0x4cdd4a)){const _0x245d6b=_0x4b739a();let _0x5d60bc=_0x52386d['readByteArray'](_0x245d6b);if(_0x3df28e){const _0x3c1966=_0x352f1e(_0x5d60bc),_0x145475=new bin_1[(_0x3a055c(0x21e))](_0x3c1966)[_0x3a055c(0x1fd)]();_0x5d60bc=(0x0,bin_2['decodeBinaryNode'])(_0x145475);}_0x5c526a(_0x5d60bc);}_0x52386d[_0x3a055c(0x211)](_0x4cdd4a);}};};function a38_0x3c7b(){const _0x83e3cc=['private','readUint16','128BHGkXN','makeNoiseHandler','NOISE_WA_HEADER','sharedKey','certification\x20match\x20failed','compare','writeUint8','ephemeral','NOISE_MODE','concat','createCipheriv','final','decompressed','proto','89745WJoTti','update','length','./crypto','77iQJBTT','5766726XTEdpx','slice','__esModule','aes-256-gcm','1211030QjmUfS','readUint8','NoiseCertificate','getAuthTag','crypto','../binary','public','486DgXMor','readByteArray','peek','../bin','1954617AwDeHU','@hapi/boom','decode','1412998CFpKrF','writeByteArray','1lDHNFJ','defineProperty','17150GIGAGl','size','payload','from','Binary','91760jdHwDY','setAAD','write','sha256','byteLength','createDecipheriv','Curve','build'];a38_0x3c7b=function(){return _0x83e3cc;};return a38_0x3c7b();}exports['makeNoiseHandler']=makeNoiseHandler;